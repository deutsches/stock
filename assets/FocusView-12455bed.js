import{_ as M,r as h,i as N,o as O,j,b as i,c as d,d as t,k as P,v as q,n as G,F,l as L,m as K,h as w,t as c,p as J,g as r,S as y,q as Y}from"./index-ba068148.js";const H={setup(){const a=h(""),u=h(null),x=h([]),e=h(""),v=h([]),{VITE_URL:f}={VITE_APIKEY:"AIzaSyD8FsfgoAZRnzsJxjCxln-rdUq52jXArQY",VITE_AUTHDOMAIN:"stock-bf37a.firebaseapp.com",VITE_DATABASEURL:"https://stock-bf37a-default-rtdb.firebaseio.com",VITE_PROJECTID:"stock-bf37a",VITE_STORAGEBUCKET:"stock-bf37a.appspot.com",VITE_MWSSAGINGSENDERID:"441545519471",VITE_APPID:"1:441545519471:web:7f747a2a080f4ace73389a",VITE_URL:"https://stock-upq4.onrender.com/",BASE_URL:"/stock/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k=h({}),m=N(()=>(console.log(a.value),a.value?v.value.filter(o=>o.name.match(a.value)||o.code.match(a.value)):""));function b(o){a.value=`${o.code}`,m.value.length=0}function l(){e.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),r.defaults.headers.common.Authorization=e.value,r.post(`${f}api/focus/getfocusStock`).then(o=>{k.value=o.data.index,x.value=o.data.resultArray}).catch(o=>{alert(o.data)})}const S=()=>{e.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),r.defaults.headers.common.Authorization=e.value;const o=v.value.filter(s=>s.name.match(a.value)||s.code.match(a.value)),_={code:o[0].code,name:o[0].name,token:e.value,stockCode:o[0].stockCode,uid:Date.parse(new Date),dealPrice:0,updown:0,change:""};r.post(`${f}api/focus/addStock`,_).then(s=>{s.success&&(y.fire({title:"加入完成!",icon:"success",showConfirmButton:!1,timer:1500}),l())}).catch(s=>{console.log(s)}),a.value=""};function p(){r.get(`${f}api/stock/getStocks`).then(o=>{v.value=o.data}).catch(o=>{console.log(o)})}const g=o=>{e.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),r.defaults.headers.common.Authorization=e.value,y.fire({title:"確定要刪除嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消"}).then(_=>{_.isConfirmed&&r.delete(`${f}api/focus/deleteStock?code=${o}`).then(s=>{s.data.success&&(y.fire({title:"已刪除完成!",icon:"success",showConfirmButton:!1,timer:1500}),l())}).catch(s=>{console.log(s)})})};return O(()=>{p(),l(),setInterval(()=>{l()},5e3)}),j(()=>{clearInterval(l)}),{search:a,stocks:m,inputValue:b,addStock:S,list:u,focusStock:x,getFocusStock:l,getStocks:p,deleteStock:g,index:k}}},Q={class:"container"},W={class:"row"},X={class:"position-relative text-center"},Z=["onClick","onKeypress"],$={class:"d-md-inline-block d-lg-flex justify-content-around mt-3"},ee={key:0},te=t("i",{class:"bi bi-arrow-up"},null,-1),oe=[te],ne={key:1},se=t("i",{class:"bi bi-arrow-down"},null,-1),ce=[se],ae={key:0},le=t("i",{class:"bi bi-arrow-up"},null,-1),ie=[le],de={key:1},re=t("i",{class:"bi bi-arrow-down"},null,-1),ue=[re],_e={class:"table-responsive"},he={class:"table mt-4"},fe=t("thead",null,[t("tr",null,[t("td",null,"名稱"),t("td",null,"現價"),t("td",null,"漲跌"),t("td",null,"幅度"),t("td")])],-1),ke=["onClick"];function me(a,u,x,e,v,f){var k,m,b,l,S,p,g,o,_,s,T,E,I,V,A,C,D,B,R,U;return i(),d("main",null,[t("div",Q,[t("div",W,[t("div",X,[P(t("input",{type:"search",id:"stock_code","onUpdate:modelValue":u[0]||(u[0]=n=>e.search=n),"aria-label":"Search",placeholder:"請輸入股票代號或是股票名稱",class:"input_stock p-2"},null,512),[[q,e.search]]),t("ul",{class:G(["list-unstyled searchList",{"d-none":!e.stocks.length,"position-absolute":e.stocks.length}])},[(i(!0),d(F,null,L(e.stocks,n=>(i(),d("li",{key:n.code,onClick:z=>e.inputValue(n),onKeypress:Y(z=>e.inputValue(n),["enter"]),role:"button",tabIndex:0,class:"p-1"},c(n.code+" "+n.name),41,Z))),128))],2),t("button",{type:"button",class:"ms-2 btn btn-outline-success",onClick:u[1]||(u[1]=(...n)=>e.addStock&&e.addStock(...n))},"加入")])]),t("div",$,[t("div",{class:"mb-2 mb-lg-0",style:K({color:((m=(k=e.index)==null?void 0:k.tse)==null?void 0:m.updown)*1>0?"red":"green"})},[w(" 加權指數："+c((l=(b=e.index)==null?void 0:b.tse)==null?void 0:l.deal)+" ",1),((p=(S=e.index)==null?void 0:S.tse)==null?void 0:p.updown)*1>0?(i(),d("span",ee,oe)):(i(),d("span",ne,ce)),w(" "+c((o=(g=e.index)==null?void 0:g.tse)==null?void 0:o.updown)+" ("+c((s=(_=e.index)==null?void 0:_.tse)==null?void 0:s.change)+") ",1)],4),t("div",{style:K({color:((E=(T=e.index)==null?void 0:T.otc)==null?void 0:E.updown)*1>0?"red":"green"})},[w(" 櫃買指數："+c((V=(I=e.index)==null?void 0:I.otc)==null?void 0:V.deal)+" ",1),((C=(A=e.index)==null?void 0:A.otc)==null?void 0:C.updown)*1>0?(i(),d("span",ae,ie)):(i(),d("span",de,ue)),w(" "+c((B=(D=e.index)==null?void 0:D.otc)==null?void 0:B.updown)+" ("+c((U=(R=e.index)==null?void 0:R.otc)==null?void 0:U.change)+") ",1)],4)]),t("div",_e,[P(t("table",he,[fe,t("tbody",null,[(i(!0),d(F,null,L(e.focusStock,n=>(i(),d("tr",{key:n.code},[t("td",null,c(n.name),1),t("td",null,c(n.dealPrice),1),t("td",null,c(n.updown),1),t("td",null,c(n.change),1),t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger",onClick:z=>e.deleteStock(n.code)}," 刪除 ",8,ke)])]))),128))])],512),[[J,e.focusStock.length]])])])])}const ve=M(H,[["render",me]]);export{ve as default};
