import{_ as K,L as M,r as h,i as j,o as q,j as G,a as J,b as d,c as r,e as Y,d as e,k as F,v as H,n as Q,F as I,l as N,m as O,h as y,t as s,p as W,g as m,S as T,q as X}from"./index-07557d5f.js";const Z={components:{Loading:M},setup(){const g=h(!1),l=h(null),a=h(""),t=h(null),E=h([]),u=h(""),v=h([]),{VITE_URL:f}={VITE_APIKEY:"AIzaSyD8FsfgoAZRnzsJxjCxln-rdUq52jXArQY",VITE_AUTHDOMAIN:"stock-bf37a.firebaseapp.com",VITE_DATABASEURL:"https://stock-bf37a-default-rtdb.firebaseio.com",VITE_PROJECTID:"stock-bf37a",VITE_STORAGEBUCKET:"stock-bf37a.appspot.com",VITE_MWSSAGINGSENDERID:"441545519471",VITE_APPID:"1:441545519471:web:7f747a2a080f4ace73389a",VITE_URL:"https://stock-upq4.onrender.com/",BASE_URL:"/stock/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k=h({}),p=j(()=>a.value?v.value.filter(o=>o.name.match(a.value)||o.code.match(a.value)):"");function S(o){a.value=`${o.code}`,p.value.length=0}function _(){u.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),m.defaults.headers.common.Authorization=u.value,m.post(`${f}api/focus/getfocusStock`).then(o=>{k.value=o.data.index,E.value=o.data.resultArray}).catch(o=>{alert(o.data)})}const w=()=>{u.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),m.defaults.headers.common.Authorization=u.value;const o=v.value.filter(i=>i.name.match(a.value)||i.code.match(a.value));if(o.length===0||a.value==="")T.fire({icon:"error",title:"Oops...",text:"沒有該個股資料，請確認是否輸入正確!"});else{const i={code:o[0].code,name:o[0].name,token:u.value,stockCode:o[0].stockCode,uid:Date.parse(new Date),dealPrice:0,updown:0,change:""};m.post(`${f}api/focus/addStock`,i).then(c=>{c.success&&(T.fire({title:"加入完成!",icon:"success",showConfirmButton:!1,timer:1500}),_())}).catch(c=>{console.log(c)}),a.value=""}};function b(){m.get(`${f}api/stock/getStocks`).then(o=>{v.value=o.data,g.value=!1}).catch(o=>{console.log(o)})}const x=o=>{u.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),m.defaults.headers.common.Authorization=u.value,T.fire({title:"確定要刪除嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消"}).then(i=>{i.isConfirmed&&m.delete(`${f}api/focus/deleteStock?code=${o}`).then(c=>{c.data.success&&(T.fire({title:"已刪除完成!",icon:"success",showConfirmButton:!1,timer:1500}),_())}).catch(c=>{console.log(c)})})};return q(()=>{b(),_(),g.value=!0,l.value=setInterval(()=>{_()},5e3)}),G(()=>{clearInterval(l.value)}),{search:a,stocks:p,inputValue:S,addStock:w,list:t,focusStock:E,getFocusStock:_,getStocks:b,deleteStock:x,index:k,isLoading:g}}},$={class:"container"},ee={class:"row"},te={class:"position-relative text-center"},oe=["onClick","onKeypress"],ne={class:"d-md-inline-block d-lg-flex justify-content-around mt-3"},se={key:0},ae=e("i",{class:"bi bi-arrow-up"},null,-1),ce=[ae],le={key:1},ie=e("i",{class:"bi bi-arrow-down"},null,-1),de=[ie],re={key:0},ue=e("i",{class:"bi bi-arrow-up"},null,-1),_e=[ue],he={key:1},fe=e("i",{class:"bi bi-arrow-down"},null,-1),me=[fe],ve={class:"table-responsive"},ke={class:"table mt-4"},pe=e("thead",null,[e("tr",null,[e("td",null,"名稱"),e("td",null,"現價"),e("td",null,"漲跌"),e("td",null,"幅度"),e("td")])],-1),be=["onClick"];function ge(g,l,a,t,E,u){var f,k,p,S,_,w,b,x,o,i,c,V,C,A,D,B,L,R,U,z;const v=J("loading");return d(),r(I,null,[Y(v,{active:t.isLoading,"onUpdate:active":l[0]||(l[0]=n=>t.isLoading=n),"can-cancel":!0},null,8,["active"]),e("main",null,[e("div",$,[e("div",ee,[e("div",te,[F(e("input",{type:"search",id:"stock_code","onUpdate:modelValue":l[1]||(l[1]=n=>t.search=n),"aria-label":"Search",placeholder:"請輸入股票代號或是股票名稱",class:"input_stock p-2"},null,512),[[H,t.search]]),e("ul",{class:Q(["list-unstyled searchList",{"d-none":!t.stocks.length,"position-absolute":t.stocks.length}])},[(d(!0),r(I,null,N(t.stocks,n=>(d(),r("li",{key:n.code,onClick:P=>t.inputValue(n),onKeypress:X(P=>t.inputValue(n),["enter"]),role:"button",tabIndex:0,class:"p-1"},s(n.code+" "+n.name),41,oe))),128))],2),e("button",{type:"button",class:"ms-2 btn btn-outline-success",onClick:l[2]||(l[2]=(...n)=>t.addStock&&t.addStock(...n))},"加入")])]),e("div",ne,[e("div",{class:"mb-2 mb-lg-0",style:O({color:((k=(f=t.index)==null?void 0:f.tse)==null?void 0:k.updown)*1>0?"red":"green"})},[y(" 加權指數："+s((S=(p=t.index)==null?void 0:p.tse)==null?void 0:S.deal)+" ",1),((w=(_=t.index)==null?void 0:_.tse)==null?void 0:w.updown)*1>0?(d(),r("span",se,ce)):(d(),r("span",le,de)),y(" "+s((x=(b=t.index)==null?void 0:b.tse)==null?void 0:x.updown)+" ("+s((i=(o=t.index)==null?void 0:o.tse)==null?void 0:i.change)+") ",1)],4),e("div",{style:O({color:((V=(c=t.index)==null?void 0:c.otc)==null?void 0:V.updown)*1>0?"red":"green"})},[y(" 櫃買指數："+s((A=(C=t.index)==null?void 0:C.otc)==null?void 0:A.deal)+" ",1),((B=(D=t.index)==null?void 0:D.otc)==null?void 0:B.updown)*1>0?(d(),r("span",re,_e)):(d(),r("span",he,me)),y(" "+s((R=(L=t.index)==null?void 0:L.otc)==null?void 0:R.updown)+" ("+s((z=(U=t.index)==null?void 0:U.otc)==null?void 0:z.change)+") ",1)],4)]),e("div",ve,[F(e("table",ke,[pe,e("tbody",null,[(d(!0),r(I,null,N(t.focusStock,n=>(d(),r("tr",{key:n.code},[e("td",null,s(n.name),1),e("td",null,s(n.dealPrice),1),e("td",null,s(n.updown),1),e("td",null,s(n.change),1),e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:P=>t.deleteStock(n.code)}," 刪除 ",8,be)])]))),128))])],512),[[W,t.focusStock.length]])])])])],64)}const we=K(Z,[["render",ge]]);export{we as default};
