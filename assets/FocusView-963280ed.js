import{_ as M,r as _,i as N,o as O,j,b as l,c as i,d as e,k as P,v as q,n as G,F,l as L,m as K,h as w,t as c,p as J,g as h,S as y,q as Y}from"./index-712efafe.js";const H={setup(){const x=_(null),s=_(""),T=_(null),t=_([]),d=_(""),p=_([]),{VITE_URL:u}={VITE_APIKEY:"AIzaSyD8FsfgoAZRnzsJxjCxln-rdUq52jXArQY",VITE_AUTHDOMAIN:"stock-bf37a.firebaseapp.com",VITE_DATABASEURL:"https://stock-bf37a-default-rtdb.firebaseio.com",VITE_PROJECTID:"stock-bf37a",VITE_STORAGEBUCKET:"stock-bf37a.appspot.com",VITE_MWSSAGINGSENDERID:"441545519471",VITE_APPID:"1:441545519471:web:7f747a2a080f4ace73389a",VITE_URL:"https://stock-upq4.onrender.com/",BASE_URL:"/stock/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k=_({}),m=N(()=>(console.log(s.value),s.value?p.value.filter(o=>o.name.match(s.value)||o.code.match(s.value)):""));function b(o){s.value=`${o.code}`,m.value.length=0}function r(){d.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),h.defaults.headers.common.Authorization=d.value,h.post(`${u}api/focus/getfocusStock`).then(o=>{k.value=o.data.index,t.value=o.data.resultArray}).catch(o=>{alert(o.data)})}const S=()=>{d.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),h.defaults.headers.common.Authorization=d.value;const o=p.value.filter(a=>a.name.match(s.value)||a.code.match(s.value)),f={code:o[0].code,name:o[0].name,token:d.value,stockCode:o[0].stockCode,uid:Date.parse(new Date),dealPrice:0,updown:0,change:""};h.post(`${u}api/focus/addStock`,f).then(a=>{a.success&&(y.fire({title:"加入完成!",icon:"success",showConfirmButton:!1,timer:1500}),r())}).catch(a=>{console.log(a)}),s.value=""};function v(){h.get(`${u}api/stock/getStocks`).then(o=>{p.value=o.data}).catch(o=>{console.log(o)})}const g=o=>{d.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),h.defaults.headers.common.Authorization=d.value,y.fire({title:"確定要刪除嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消"}).then(f=>{f.isConfirmed&&h.delete(`${u}api/focus/deleteStock?code=${o}`).then(a=>{a.data.success&&(y.fire({title:"已刪除完成!",icon:"success",showConfirmButton:!1,timer:1500}),r())}).catch(a=>{console.log(a)})})};return O(()=>{v(),r(),x.value=setInterval(()=>{r()},5e3)}),j(()=>{clearInterval(x.value)}),{search:s,stocks:m,inputValue:b,addStock:S,list:T,focusStock:t,getFocusStock:r,getStocks:v,deleteStock:g,index:k}}},Q={class:"container"},W={class:"row"},X={class:"position-relative text-center"},Z=["onClick","onKeypress"],$={class:"d-md-inline-block d-lg-flex justify-content-around mt-3"},ee={key:0},te=e("i",{class:"bi bi-arrow-up"},null,-1),oe=[te],ne={key:1},se=e("i",{class:"bi bi-arrow-down"},null,-1),ae=[se],ce={key:0},le=e("i",{class:"bi bi-arrow-up"},null,-1),ie=[le],de={key:1},re=e("i",{class:"bi bi-arrow-down"},null,-1),ue=[re],_e={class:"table-responsive"},he={class:"table mt-4"},fe=e("thead",null,[e("tr",null,[e("td",null,"名稱"),e("td",null,"現價"),e("td",null,"漲跌"),e("td",null,"幅度"),e("td")])],-1),ke=["onClick"];function me(x,s,T,t,d,p){var u,k,m,b,r,S,v,g,o,f,a,E,I,V,A,C,D,B,R,U;return l(),i("main",null,[e("div",Q,[e("div",W,[e("div",X,[P(e("input",{type:"search",id:"stock_code","onUpdate:modelValue":s[0]||(s[0]=n=>t.search=n),"aria-label":"Search",placeholder:"請輸入股票代號或是股票名稱",class:"input_stock p-2"},null,512),[[q,t.search]]),e("ul",{class:G(["list-unstyled searchList",{"d-none":!t.stocks.length,"position-absolute":t.stocks.length}])},[(l(!0),i(F,null,L(t.stocks,n=>(l(),i("li",{key:n.code,onClick:z=>t.inputValue(n),onKeypress:Y(z=>t.inputValue(n),["enter"]),role:"button",tabIndex:0,class:"p-1"},c(n.code+" "+n.name),41,Z))),128))],2),e("button",{type:"button",class:"ms-2 btn btn-outline-success",onClick:s[1]||(s[1]=(...n)=>t.addStock&&t.addStock(...n))},"加入")])]),e("div",$,[e("div",{class:"mb-2 mb-lg-0",style:K({color:((k=(u=t.index)==null?void 0:u.tse)==null?void 0:k.updown)*1>0?"red":"green"})},[w(" 加權指數："+c((b=(m=t.index)==null?void 0:m.tse)==null?void 0:b.deal)+" ",1),((S=(r=t.index)==null?void 0:r.tse)==null?void 0:S.updown)*1>0?(l(),i("span",ee,oe)):(l(),i("span",ne,ae)),w(" "+c((g=(v=t.index)==null?void 0:v.tse)==null?void 0:g.updown)+" ("+c((f=(o=t.index)==null?void 0:o.tse)==null?void 0:f.change)+") ",1)],4),e("div",{style:K({color:((E=(a=t.index)==null?void 0:a.otc)==null?void 0:E.updown)*1>0?"red":"green"})},[w(" 櫃買指數："+c((V=(I=t.index)==null?void 0:I.otc)==null?void 0:V.deal)+" ",1),((C=(A=t.index)==null?void 0:A.otc)==null?void 0:C.updown)*1>0?(l(),i("span",ce,ie)):(l(),i("span",de,ue)),w(" "+c((B=(D=t.index)==null?void 0:D.otc)==null?void 0:B.updown)+" ("+c((U=(R=t.index)==null?void 0:R.otc)==null?void 0:U.change)+") ",1)],4)]),e("div",_e,[P(e("table",he,[fe,e("tbody",null,[(l(!0),i(F,null,L(t.focusStock,n=>(l(),i("tr",{key:n.code},[e("td",null,c(n.name),1),e("td",null,c(n.dealPrice),1),e("td",null,c(n.updown),1),e("td",null,c(n.change),1),e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:z=>t.deleteStock(n.code)}," 刪除 ",8,ke)])]))),128))])],512),[[J,t.focusStock.length]])])])])}const pe=M(H,[["render",me]]);export{pe as default};
