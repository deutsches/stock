import{_ as z,L as K,r,i as j,j as Y,o as q,k as G,a as J,b as u,c as h,e as H,d as e,l as I,v as Q,F as A,m as $,n as M,h as y,t as c,p as N,g as m,S as p,q as W}from"./index-02d7d273.js";const X={components:{Loading:K},setup(){const S=r(!1),i=r(null),l=r(""),o=r(null),E=r([]),f=r(""),w=r([]),{VITE_URL:_}={VITE_APIKEY:"AIzaSyD8FsfgoAZRnzsJxjCxln-rdUq52jXArQY",VITE_AUTHDOMAIN:"stock-bf37a.firebaseapp.com",VITE_DATABASEURL:"https://stock-bf37a-default-rtdb.firebaseio.com",VITE_PROJECTID:"stock-bf37a",VITE_STORAGEBUCKET:"stock-bf37a.appspot.com",VITE_MWSSAGINGSENDERID:"441545519471",VITE_APPID:"1:441545519471:web:7f747a2a080f4ace73389a",VITE_URL:"https://stock-upq4.onrender.com/",BASE_URL:"/stock/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k=r({}),v=r(!1),b=j(()=>l.value?w.value.filter(t=>t.name.match(l.value)||t.code.match(l.value)):"");Y(()=>b.value,()=>{v.value=!0});function x(t){l.value=`${t.code}`,v.value=!1}function d(){f.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),m.defaults.headers.common.Authorization=f.value,m.post(`${_}api/focus/getfocusStock`).then(t=>{k.value=t.data.index,E.value=t.data.resultArray}).catch(t=>{alert(t.data)})}const D=()=>{f.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),m.defaults.headers.common.Authorization=f.value;const t=w.value.filter(a=>a.name.match(l.value)||a.code.match(l.value));if(t.length===0||l.value==="")p.fire({icon:"error",title:"Oops...",text:"沒有該個股資料，請確認是否輸入正確!"});else{const a={code:t[0].code,name:t[0].name,token:f.value,stockCode:t[0].stockCode,uid:Date.parse(new Date),dealPrice:0,updown:0,change:""};m.post(`${_}api/focus/addStock`,a).then(s=>{s.data.success&&(p.fire({title:"加入完成!",icon:"success",showConfirmButton:!1,timer:1500}),d())}).catch(s=>{console.log(s)}),l.value=""}};function g(){m.get(`${_}api/stock/getStocks`).then(t=>{w.value=t.data,S.value=!1}).catch(t=>{console.log(t)})}const C=t=>{f.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),m.defaults.headers.common.Authorization=f.value,p.fire({title:"確定要刪除嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消"}).then(a=>{a.isConfirmed&&m.delete(`${_}api/focus/deleteStock?code=${t}`).then(s=>{s.data.success&&(p.fire({title:"已刪除完成!",icon:"success",showConfirmButton:!1,timer:1500}),d())}).catch(s=>{console.log(s)})})};function T(t){console.log(t),p.fire({title:"設定要警示的價格",input:"text",inputValue:t.notice.dealPrice,showCancelButton:!0,confirmButtonText:"確認",cancelButtonText:"取消",showLoaderOnConfirm:!0,preConfirm:a=>{m.post(`${_}api/focus/updateNoticePrice?code=${t.code}&dealPrice=${a}`).then(s=>{s.data.success&&(p.fire({title:"已設定完成!",icon:"success",showConfirmButton:!1,timer:1500}),d())}).catch(s=>{console.log(s)})},allowOutsideClick:()=>!p.isLoading()}).then(a=>{a.isConfirmed&&p.fire({title:"設定完成!"})})}return q(()=>{g(),d(),S.value=!0,i.value=setInterval(()=>{const t=Date.parse(new Date),a=Date.parse(`${new Date().getFullYear()}/${new Date().getMonth()}/${new Date().getDate()} 09:00:00`),s=Date.parse(`${new Date().getFullYear()}/${new Date().getMonth()}/${new Date().getDate()} 13:30:00`);t>=a&&t<=s&&d()},5e3)}),G(()=>{clearInterval(i.value)}),{search:l,stocks:b,inputValue:x,addStock:D,list:o,focusStock:E,getFocusStock:d,getStocks:g,deleteStock:C,index:k,isLoading:S,updateStockPrice:T,showList:v}}},Z={class:"container"},ee={class:"row"},te={class:"position-relative text-center p-2"},oe={class:"list-unstyled searchList position-absolute"},ne=["onClick","onKeypress"],se={class:"d-md-inline-block d-lg-flex justify-content-around mt-3"},ae={key:0},ce=e("i",{class:"bi bi-arrow-up"},null,-1),le=[ce],ie={key:1},de=e("i",{class:"bi bi-arrow-down"},null,-1),re=[de],ue={key:0},he=e("i",{class:"bi bi-arrow-up"},null,-1),fe=[he],_e={key:1},me=e("i",{class:"bi bi-arrow-down"},null,-1),pe=[me],ve={class:"table-responsive"},we={class:"table mt-4"},ke=e("thead",null,[e("tr",null,[e("td",null,"名稱"),e("td",null,"現價"),e("td",null,"漲跌"),e("td",null,"幅度"),e("td",{width:"150"}),e("td",{width:"150"})])],-1),be=["onClick"],ge=["onClick"];function Se(S,i,l,o,E,f){var _,k,v,b,x,d,D,g,C,T,t,a,s,B,L,P,R,U,F,O;const w=J("loading");return u(),h(A,null,[H(w,{active:o.isLoading,"onUpdate:active":i[0]||(i[0]=n=>o.isLoading=n),"can-cancel":!0},null,8,["active"]),e("main",null,[e("div",Z,[e("div",ee,[e("div",te,[I(e("input",{type:"search",id:"stock_code","onUpdate:modelValue":i[1]||(i[1]=n=>o.search=n),"aria-label":"Search",placeholder:"請輸入股票代號或是股票名稱",class:"input_stock p-2"},null,512),[[Q,o.search]]),e("button",{type:"button",class:"ms-2 btn btn-outline-success",onClick:i[2]||(i[2]=(...n)=>o.addStock&&o.addStock(...n))},"加入"),e("ul",oe,[(u(!0),h(A,null,$(o.stocks,n=>I((u(),h("li",{key:n.code,onClick:V=>o.inputValue(n),onKeypress:W(V=>o.inputValue(n),["enter"]),role:"button",tabIndex:0,class:"p-1"},c(n.code+" "+n.name),41,ne)),[[N,o.showList]])),128))])])]),e("div",se,[e("div",{class:"mb-2 mb-lg-0",style:M({color:((k=(_=o.index)==null?void 0:_.tse)==null?void 0:k.updown)*1>0?"red":"green"})},[y(" 加權指數："+c((b=(v=o.index)==null?void 0:v.tse)==null?void 0:b.deal)+" ",1),((d=(x=o.index)==null?void 0:x.tse)==null?void 0:d.updown)*1>0?(u(),h("span",ae,le)):(u(),h("span",ie,re)),y(" "+c((g=(D=o.index)==null?void 0:D.tse)==null?void 0:g.updown)+" ("+c((T=(C=o.index)==null?void 0:C.tse)==null?void 0:T.change)+") ",1)],4),e("div",{style:M({color:((a=(t=o.index)==null?void 0:t.otc)==null?void 0:a.updown)*1>0?"red":"green"})},[y(" 櫃買指數："+c((B=(s=o.index)==null?void 0:s.otc)==null?void 0:B.deal)+" ",1),((P=(L=o.index)==null?void 0:L.otc)==null?void 0:P.updown)*1>0?(u(),h("span",ue,fe)):(u(),h("span",_e,pe)),y(" "+c((U=(R=o.index)==null?void 0:R.otc)==null?void 0:U.updown)+" ("+c((O=(F=o.index)==null?void 0:F.otc)==null?void 0:O.change)+") ",1)],4)]),e("div",ve,[I(e("table",we,[ke,e("tbody",null,[(u(!0),h(A,null,$(o.focusStock,n=>(u(),h("tr",{key:n.code},[e("td",null,c(n.name),1),e("td",null,c(n.dealPrice),1),e("td",null,c(n.updown),1),e("td",null,c(n.change),1),e("td",null,[e("button",{type:"button",class:"btn btn-outline-success",onClick:V=>o.updateStockPrice(n)}," 設定警示價格 ",8,be)]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:V=>o.deleteStock(n==null?void 0:n.code)}," 刪除 ",8,ge)])]))),128))])],512),[[N,o.focusStock.length]])])])])],64)}const De=z(X,[["render",Se]]);export{De as default};
