import{_ as N,L as $,r as _,i as K,o as j,j as Y,a as q,b as r,c as u,e as G,d as e,k as O,v as J,n as H,F as V,l as z,m as M,h as T,t as c,p as Q,g as m,S as p,q as W}from"./index-49f49ec1.js";const X={components:{Loading:$},setup(){const w=_(!1),i=_(null),l=_(""),o=_(null),y=_([]),h=_(""),v=_([]),{VITE_URL:f}={VITE_APIKEY:"AIzaSyD8FsfgoAZRnzsJxjCxln-rdUq52jXArQY",VITE_AUTHDOMAIN:"stock-bf37a.firebaseapp.com",VITE_DATABASEURL:"https://stock-bf37a-default-rtdb.firebaseio.com",VITE_PROJECTID:"stock-bf37a",VITE_STORAGEBUCKET:"stock-bf37a.appspot.com",VITE_MWSSAGINGSENDERID:"441545519471",VITE_APPID:"1:441545519471:web:7f747a2a080f4ace73389a",VITE_URL:"https://stock-upq4.onrender.com/",BASE_URL:"/stock/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k=_({}),g=K(()=>l.value?v.value.filter(t=>t.name.match(l.value)||t.code.match(l.value)):"");function S(t){l.value=`${t.code}`,g.value.length=0}function d(){h.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),m.defaults.headers.common.Authorization=h.value,m.post(`${f}api/focus/getfocusStock`).then(t=>{k.value=t.data.index,y.value=t.data.resultArray}).catch(t=>{alert(t.data)})}const x=()=>{h.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),m.defaults.headers.common.Authorization=h.value;const t=v.value.filter(a=>a.name.match(l.value)||a.code.match(l.value));if(t.length===0||l.value==="")p.fire({icon:"error",title:"Oops...",text:"沒有該個股資料，請確認是否輸入正確!"});else{const a={code:t[0].code,name:t[0].name,token:h.value,stockCode:t[0].stockCode,uid:Date.parse(new Date),dealPrice:0,updown:0,change:""};m.post(`${f}api/focus/addStock`,a).then(s=>{s.success&&(p.fire({title:"加入完成!",icon:"success",showConfirmButton:!1,timer:1500}),d())}).catch(s=>{console.log(s)}),l.value=""}};function b(){m.get(`${f}api/stock/getStocks`).then(t=>{v.value=t.data,w.value=!1}).catch(t=>{console.log(t)})}const D=t=>{h.value=document.cookie.replace(/(?:(?:^|.*;\s*)stockToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),m.defaults.headers.common.Authorization=h.value,p.fire({title:"確定要刪除嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消"}).then(a=>{a.isConfirmed&&m.delete(`${f}api/focus/deleteStock?code=${t}`).then(s=>{s.data.success&&(p.fire({title:"已刪除完成!",icon:"success",showConfirmButton:!1,timer:1500}),d())}).catch(s=>{console.log(s)})})};function C(t){console.log(t),p.fire({title:"設定要警示的價格",input:"text",inputValue:t.notice.dealPrice,showCancelButton:!0,confirmButtonText:"確認",cancelButtonText:"取消",showLoaderOnConfirm:!0,preConfirm:a=>{m.post(`${f}api/focus/updateNoticePrice?code=${t.code}&dealPrice=${a}`).then(s=>{s.data.success&&(p.fire({title:"已設定完成!",icon:"success",showConfirmButton:!1,timer:1500}),d())}).catch(s=>{console.log(s)})},allowOutsideClick:()=>!p.isLoading()}).then(a=>{a.isConfirmed&&p.fire({title:"設定完成!"})})}return j(()=>{b(),d(),w.value=!0,i.value=setInterval(()=>{const t=Date.parse(new Date),a=Date.parse(`${new Date().getFullYear()}/${new Date().getMonth()}/${new Date().getDate()} 09:00:00`),s=Date.parse(`${new Date().getFullYear()}/${new Date().getMonth()}/${new Date().getDate()} 13:30:00`);t>=a&&t<=s&&d()},5e3)}),Y(()=>{clearInterval(i.value)}),{search:l,stocks:g,inputValue:S,addStock:x,list:o,focusStock:y,getFocusStock:d,getStocks:b,deleteStock:D,index:k,isLoading:w,updateStockPrice:C}}},Z={class:"container"},ee={class:"row"},te={class:"position-relative text-center"},oe=["onClick","onKeypress"],ne={class:"d-md-inline-block d-lg-flex justify-content-around mt-3"},se={key:0},ae=e("i",{class:"bi bi-arrow-up"},null,-1),ce=[ae],le={key:1},ie=e("i",{class:"bi bi-arrow-down"},null,-1),de=[ie],re={key:0},ue=e("i",{class:"bi bi-arrow-up"},null,-1),he=[ue],fe={key:1},_e=e("i",{class:"bi bi-arrow-down"},null,-1),me=[_e],pe={class:"table-responsive"},ve={class:"table mt-4"},ke=e("thead",null,[e("tr",null,[e("td",null,"名稱"),e("td",null,"現價"),e("td",null,"漲跌"),e("td",null,"幅度"),e("td",{width:"150"}),e("td",{width:"150"})])],-1),ge=["onClick"],be=["onClick"];function we(w,i,l,o,y,h){var f,k,g,S,d,x,b,D,C,t,a,s,I,A,B,L,P,R,U,F;const v=q("loading");return r(),u(V,null,[G(v,{active:o.isLoading,"onUpdate:active":i[0]||(i[0]=n=>o.isLoading=n),"can-cancel":!0},null,8,["active"]),e("main",null,[e("div",Z,[e("div",ee,[e("div",te,[O(e("input",{type:"search",id:"stock_code","onUpdate:modelValue":i[1]||(i[1]=n=>o.search=n),"aria-label":"Search",placeholder:"請輸入股票代號或是股票名稱",class:"input_stock p-2"},null,512),[[J,o.search]]),e("ul",{class:H(["list-unstyled searchList",{"d-none":!o.stocks.length,"position-absolute":o.stocks.length}])},[(r(!0),u(V,null,z(o.stocks,n=>(r(),u("li",{key:n.code,onClick:E=>o.inputValue(n),onKeypress:W(E=>o.inputValue(n),["enter"]),role:"button",tabIndex:0,class:"p-1"},c(n.code+" "+n.name),41,oe))),128))],2),e("button",{type:"button",class:"ms-2 btn btn-outline-success",onClick:i[2]||(i[2]=(...n)=>o.addStock&&o.addStock(...n))},"加入")])]),e("div",ne,[e("div",{class:"mb-2 mb-lg-0",style:M({color:((k=(f=o.index)==null?void 0:f.tse)==null?void 0:k.updown)*1>0?"red":"green"})},[T(" 加權指數："+c((S=(g=o.index)==null?void 0:g.tse)==null?void 0:S.deal)+" ",1),((x=(d=o.index)==null?void 0:d.tse)==null?void 0:x.updown)*1>0?(r(),u("span",se,ce)):(r(),u("span",le,de)),T(" "+c((D=(b=o.index)==null?void 0:b.tse)==null?void 0:D.updown)+" ("+c((t=(C=o.index)==null?void 0:C.tse)==null?void 0:t.change)+") ",1)],4),e("div",{style:M({color:((s=(a=o.index)==null?void 0:a.otc)==null?void 0:s.updown)*1>0?"red":"green"})},[T(" 櫃買指數："+c((A=(I=o.index)==null?void 0:I.otc)==null?void 0:A.deal)+" ",1),((L=(B=o.index)==null?void 0:B.otc)==null?void 0:L.updown)*1>0?(r(),u("span",re,he)):(r(),u("span",fe,me)),T(" "+c((R=(P=o.index)==null?void 0:P.otc)==null?void 0:R.updown)+" ("+c((F=(U=o.index)==null?void 0:U.otc)==null?void 0:F.change)+") ",1)],4)]),e("div",pe,[O(e("table",ve,[ke,e("tbody",null,[(r(!0),u(V,null,z(o.focusStock,n=>(r(),u("tr",{key:n.code},[e("td",null,c(n.name),1),e("td",null,c(n.dealPrice),1),e("td",null,c(n.updown),1),e("td",null,c(n.change),1),e("td",null,[e("button",{type:"button",class:"btn btn-outline-success",onClick:E=>o.updateStockPrice(n)}," 設定警示價格 ",8,ge)]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:E=>o.deleteStock(n==null?void 0:n.code)}," 刪除 ",8,be)])]))),128))])],512),[[Q,o.focusStock.length]])])])])],64)}const xe=N(X,[["render",we]]);export{xe as default};
